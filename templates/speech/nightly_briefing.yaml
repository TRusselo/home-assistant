>
  {#  Nightly Report #}
  {%- macro getReport() -%}

    <p>
      {% if states.sensor.halloween_countdown.state | int == 1 %}
      Tomorrow is Halloween. I hope you have picked out a costume.
      {{ [ 'I will be going as a dumb home. ',
      'I have prepped the scary music. Just in case.',
      'I will be going as HAL 9000. The Pod Bay Doors are being installed today. I dare you to ask me to open them. '
      ] | random }}
      {% elif states.sensor.halloween_countdown.state | int < 30 %}
      There are only {{states.sensor.halloween_countdown.state}} days 
      {{ [ 'until Halloween.',
      'until Halloween. It might not be enough time. ',
      'and counting until the best holiday ever.',
      'until you need a costume.'
      ] | random }} 

      {% else %}  
      {% endif %}

  {%- endmacro -%}


  {# a macro that removes all newline characters, empty spaces, and returns formatted text  #}
    {%- macro cleanup(data) -%}
      {%- for item in data.split("\n")  if item | trim != "" -%}
        {{ item | trim }} {% endfor -%}
  {%- endmacro -%}

  {# a macro to call all macros :)  #}
    {%- macro mother_of_all_macros() -%}
      {{ getReport() }}
    {%- endmacro -%}
    
    {# Call the macro  #}
    {{- cleanup(mother_of_all_macros()) -}}